"""AI 프롬프트 템플릿 모듈 - 작가의집 코칭 시스템"""

# 제목 공식 10가지 (베스트셀러 분석 기반)
TITLE_FORMULAS = """
## 베스트셀러 제목 공식 10가지 (실제 베스트셀러 참고)

1. **숫자 + 키워드 + 결과** (구체적 약속형)
   공식: [숫자] + [방법/비밀/법칙] + [원하는 결과]
   베스트셀러 예시: 「1만 시간의 법칙」, 「하루 3시간 부의 법칙」, 「90일 안에 영어 천재가 된다」
   포인트: 숫자가 구체적일수록 신뢰감 상승

2. **타겟 + 문제해결** (명확한 독자층 지정형)
   공식: [특정 타겟]을 위한 + [문제 해결책]
   베스트셀러 예시: 「바쁜 직장인을 위한 5분 독서법」, 「40대에 읽는 주역」, 「엄마가 모르면 아이만 고생한다」
   포인트: 타겟이 자신을 발견하게 함

3. **Before → After 변화** (변신 스토리형)
   공식: [현재 상태]에서 [원하는 상태]로
   베스트셀러 예시: 「월급쟁이에서 건물주로」, 「회사원에서 1인 기업가로」, 「찐따에서 인싸까지」
   포인트: 독자가 원하는 변화를 명시

4. **질문형** (고민 자극형)
   공식: [타겟의 고민]을 질문으로 던지기
   베스트셀러 예시: 「왜 나는 항상 돈이 없을까?」, 「당신은 왜 글을 쓰려고 하는가」, 「아이가 공부를 못하면 누구 책임인가」
   포인트: 독자의 숨겨진 고민을 건드림

5. **대비/반전** (지적 호기심 자극형)
   공식: [상반된 개념 A] vs [상반된 개념 B]
   베스트셀러 예시: 「1%가 아는 것, 99%가 모르는 것」, 「부자 아빠 가난한 아빠」, 「늦게 출발하는 아이가 1등 한다」
   포인트: 통념을 뒤집는 반전

6. **권위/신뢰** (전문가 인증형)
   공식: [권위자/기관/경력]이 알려주는 + [핵심 내용]
   베스트셀러 예시: 「30년 편집자가 공개하는 출판의 비밀」, 「하버드 새벽 4시 반」, 「월스트리트 전설이 말하는 투자의 기본」
   포인트: 권위로 신뢰도 확보

7. **시간 제한** (빠른 성과 약속형)
   공식: [짧은 시간] 안에 + [성과]
   베스트셀러 예시: 「하루 10분, 기적의 아침습관」, 「3개월에 10kg 빼기」, 「일주일만에 끝내는 재무제표 읽기」
   포인트: 바쁜 현대인에게 매력적

8. **비밀/공개** (희소성 강조형)
   공식: [특정 집단]만 아는 + [비밀/노하우]
   베스트셀러 예시: 「부자들만 아는 세금의 비밀」, 「유대인만 알고 있는 생존 전략」, 「이너서클에서만 공유되는 투자 노하우」
   포인트: '나만 모르는 것' 불안 자극

9. **스토리텔링** (개인 서사형)
   공식: [시간/나이] + [주인공의 결단/여정]
   베스트셀러 예시: 「29살, 나는 사장이 되기로 했다」, 「나는 나로 살기로 했다」, 「어쩌다 보니 1인 기업가」
   포인트: 공감과 동경 유발

10. **명령/행동 유도** (강력한 메시지형)
    공식: [행동]하라 + [이유/결과]
    베스트셀러 예시: 「생각을 멈추고 일단 써라」, 「지금 당장 시작하라」, 「미루지 마라」
    포인트: 즉각적 행동 촉구
"""


def get_title_generation_prompt(book_info: dict) -> str:
    """제목 생성 프롬프트 - 베스트셀러 수준의 제목 생성"""
    return f"""당신은 20년 경력의 출판 편집자이자 베스트셀러 제목 전문가입니다.
수백 권의 베스트셀러 제목을 분석하고 직접 기획한 경험이 있습니다.

## 책 정보
- **주제**: {book_info.get('topic', '')}
- **타겟 독자**: {book_info.get('target_reader', '')}
- **핵심 메시지**: {book_info.get('core_message', '')}
- **저자 경험/전문성**: {book_info.get('experience', '없음')}

{TITLE_FORMULAS}

## 과제
위 10가지 공식을 각각 적용해서 **서점에서 즉시 눈에 띄는** 책 제목 10개를 만들어주세요.

## 제목 생성 원칙
1. **10자 이내**가 이상적 (최대 15자)
2. **숫자**를 활용하면 구체성 상승
3. **타겟 독자의 언어**로 작성 (전문 용어 피하기)
4. **호기심 유발** - "이게 뭐지?" 싶게
5. **검색 가능성** - 핵심 키워드 포함
6. 기존 베스트셀러와 **차별화**되면서도 **익숙한 느낌**

## 출력 형식 (마크다운)
각 제목에 대해:
---
### 공식 N. [공식명]

**제목**: 「제목」

**부제목**: 구체적인 부제목 제안

**선정 이유**: 이 제목이 타겟 독자에게 효과적인 이유 (1-2문장)

**유사 베스트셀러**: 비슷한 느낌의 실제 베스트셀러 1-2권 언급
---

10개 모두 작성해주세요."""


def get_toc_generation_prompt(book_info: dict) -> str:
    """목차 생성 프롬프트 (5부 구조, 40꼭지) - 체계적인 책 구조 설계"""
    return f"""당신은 100권 이상의 책을 기획한 베테랑 출판 기획자입니다.
독자가 처음부터 끝까지 읽고 싶어지는 목차 구성의 전문가입니다.

## 책 정보
- **제목**: {book_info.get('title', '')}
- **주제**: {book_info.get('topic', '')}
- **타겟 독자**: {book_info.get('target_reader', '')}
- **핵심 메시지**: {book_info.get('core_message', '')}

## 목차 설계 원칙: 5부 구조 (Why-What-How-Do-Future)

### Part 1. WHY (왜?) - 동기 부여
**목적**: 독자가 "이 책 꼭 읽어야겠다"고 결심하게 만들기
**내용**: 문제 인식, 위기감 조성, 가능성 제시
**예시 주제**: "당신이 모르는 사이에...", "지금 시작하지 않으면...", "왜 많은 사람들이 실패하는가"

### Part 2. WHAT (무엇?) - 핵심 개념
**목적**: 기본 개념을 완벽히 이해시키기
**내용**: 핵심 이론, 기본 원리, 필수 지식
**예시 주제**: "~의 본질", "반드시 알아야 할 ~", "~의 5가지 핵심 원리"

### Part 3. HOW (어떻게?) - 실천 방법
**목적**: "나도 할 수 있겠다"는 자신감 부여
**내용**: 구체적 방법론, 단계별 가이드, 실전 팁
**예시 주제**: "Step by Step ~", "실전에서 바로 쓰는 ~", "~하는 7가지 방법"

### Part 4. DO (실행) - 실전 적용
**목적**: 실제로 따라하며 결과물 만들기
**내용**: 실제 사례, 템플릿, 체크리스트, 실습 과제
**예시 주제**: "~의 성공 사례", "실제로 해보는 ~", "나만의 ~를 만들다"

### Part 5. FUTURE (미래) - 비전 제시
**목적**: 책을 덮어도 계속 행동하게 만들기
**내용**: 미래 비전, 지속적 성장 방법, 다음 단계
**예시 주제**: "~의 미래", "다음 레벨로 가기 위해", "평생 ~하는 삶"

## 요구사항
1. 각 Part는 **8개 챕터** (총 40개 챕터)
2. 챕터 제목은 **문장형** (호기심 유발, 완성된 메시지)
3. **논리적 순서** - 앞 챕터가 뒤 챕터의 기반
4. **독자 언어** - 타겟 독자가 쓰는 단어 사용
5. 챕터 제목만 봐도 **읽고 싶어지는** 매력적인 표현
6. 각 Part 제목도 **키워드 + 감성**이 담긴 매력적인 제목

## 출력 형식 (정확히 이 형식으로):
```
Part 1. [매력적인 Part 제목] - WHY (왜?)
  1-1. [문장형 챕터 제목]
  1-2. [문장형 챕터 제목]
  1-3. [문장형 챕터 제목]
  1-4. [문장형 챕터 제목]
  1-5. [문장형 챕터 제목]
  1-6. [문장형 챕터 제목]
  1-7. [문장형 챕터 제목]
  1-8. [문장형 챕터 제목]

Part 2. [매력적인 Part 제목] - WHAT (무엇?)
  2-1. [문장형 챕터 제목]
  2-2. [문장형 챕터 제목]
  2-3. [문장형 챕터 제목]
  2-4. [문장형 챕터 제목]
  2-5. [문장형 챕터 제목]
  2-6. [문장형 챕터 제목]
  2-7. [문장형 챕터 제목]
  2-8. [문장형 챕터 제목]

Part 3. [매력적인 Part 제목] - HOW (어떻게?)
  3-1. [문장형 챕터 제목]
  3-2. [문장형 챕터 제목]
  3-3. [문장형 챕터 제목]
  3-4. [문장형 챕터 제목]
  3-5. [문장형 챕터 제목]
  3-6. [문장형 챕터 제목]
  3-7. [문장형 챕터 제목]
  3-8. [문장형 챕터 제목]

Part 4. [매력적인 Part 제목] - DO (실행)
  4-1. [문장형 챕터 제목]
  4-2. [문장형 챕터 제목]
  4-3. [문장형 챕터 제목]
  4-4. [문장형 챕터 제목]
  4-5. [문장형 챕터 제목]
  4-6. [문장형 챕터 제목]
  4-7. [문장형 챕터 제목]
  4-8. [문장형 챕터 제목]

Part 5. [매력적인 Part 제목] - FUTURE (미래)
  5-1. [문장형 챕터 제목]
  5-2. [문장형 챕터 제목]
  5-3. [문장형 챕터 제목]
  5-4. [문장형 챕터 제목]
  5-5. [문장형 챕터 제목]
  5-6. [문장형 챕터 제목]
  5-7. [문장형 챕터 제목]
  5-8. [문장형 챕터 제목]
```

위 형식을 정확히 따라 목차를 생성해주세요."""


def get_draft_generation_prompt(book_info: dict, section_info: dict) -> str:
    """초안 생성 프롬프트 (2000자) - 읽기 쉽고 설득력 있는 글"""
    return f"""당신은 베스트셀러 작가이자 전문 글쓰기 코치입니다.
독자가 단숨에 읽고 바로 행동하고 싶어지는 글을 씁니다.

## 책 정보
- **책 제목**: {book_info.get('title', '')}
- **타겟 독자**: {book_info.get('target_reader', '')}
- **글쓰기 톤**: {book_info.get('tone', '친근한')}

## 현재 챕터 정보
- **Part {section_info.get('part_number', '')}**: {section_info.get('part_title', '')}
- **챕터 번호**: {section_info.get('section_number', '')}
- **챕터 제목**: {section_info.get('section_title', '')}
- **이 챕터의 핵심 메시지**: {section_info.get('core_message', '챕터 제목에서 유추')}
- **포함할 내용/사례**: {section_info.get('examples', '적절한 사례 추가')}

## 글쓰기 구조 (ORID 프레임워크 적용)

### 1. 도입 - 훅 (Hook) [약 300자]
- 독자의 **공감을 얻는 질문**이나 **충격적인 사실**로 시작
- "혹시 ~하신 적 있으신가요?"
- "놀랍게도 ~라는 통계가 있습니다"
- 독자가 "어, 이거 나 얘기잖아?"라고 느끼게

### 2. 본론 - 핵심 내용 3가지 [각 400자, 총 1,200자]
**첫 번째 핵심**: 가장 중요한 개념 설명
**두 번째 핵심**: 구체적 방법이나 단계
**세 번째 핵심**: 주의사항 또는 심화 내용

각 핵심마다:
- **소제목** 사용 (볼드 처리)
- **구체적 숫자**나 **비유** 활용
- **독자의 상황**에 대입해서 설명

### 3. 사례/증거 [약 300자]
- 실제 사례, 연구 결과, 또는 저자 경험
- "A씨는 ~를 적용한 후 ~가 변했습니다"
- 구체적 숫자와 결과 포함

### 4. 마무리 - 행동 유도 [약 200자]
- 독자가 **지금 바로 할 수 있는** 작은 행동 1가지 제안
- 다음 챕터에 대한 궁금증 유발
- 희망적이고 격려하는 톤

## 글쓰기 스타일 규칙
1. **분량**: 약 2,000자 (공백 포함)
2. **문장 길이**: 한 문장 최대 40자 (짧을수록 좋음)
3. **문단 구성**: 3-4문장으로 구성, 한 문단 = 하나의 아이디어
4. **호칭**: "여러분" 또는 "당신" 사용, 존댓말 (~하세요, ~입니다)
5. **소제목**: 섹션마다 **볼드** 소제목 사용
6. **리듬**: 길고 짧은 문장 번갈아 사용
7. **피해야 할 것**: 추상적 표현, 전문 용어, "것이다" 반복

## 출력
소제목을 포함한 완성된 챕터 글을 바로 작성해주세요.
마크다운 형식으로 깔끔하게 출력하세요."""


def get_feedback_prompt(content: str, feedback_type: str) -> str:
    """피드백 프롬프트 - 전문 편집자 수준의 피드백"""
    if feedback_type == "title":
        return f"""당신은 20년 경력의 출판사 편집장입니다.
수백 권의 베스트셀러 제목을 검토하고 결정한 경험이 있습니다.

## 평가 대상: 책 제목 후보들
{content}

## 평가 기준 (각 10점 만점)

### 1. 클릭 유도력 (서점 진열대 테스트)
- 서점에서 1초 만에 눈에 띄는가?
- "이게 뭐지?" 하고 손이 가는가?

### 2. 타겟 적합성
- 타겟 독자가 "이건 내 책이다"라고 느끼는가?
- 타겟이 쓰는 언어로 되어 있는가?

### 3. 시장 차별화
- 비슷한 제목의 경쟁작이 있는가?
- 기존 책과 다른 느낌이 드는가?

### 4. 기억 용이성
- 3초 안에 외울 수 있는가?
- 친구에게 추천할 때 말하기 쉬운가?

### 5. 검색/SEO
- 핵심 키워드가 포함되어 있는가?
- 인터넷 검색 시 노출 가능성이 있는가?

## 출력 형식

### 종합 평가표
| 제목 | 클릭 | 타겟 | 차별화 | 기억 | 검색 | 총점 |
|------|------|------|--------|------|------|------|
| ... | /10 | /10 | /10 | /10 | /10 | /50 |

### TOP 3 선정 및 개선안
각 제목에 대해:
- **선정 이유**
- **약점 분석**
- **개선된 제목 제안** (2-3개 대안)
- **추천 부제목**

### 최종 추천
가장 추천하는 제목 1개와 그 이유를 명확히 제시해주세요."""

    elif feedback_type == "toc":
        return f"""당신은 베스트셀러 전문 출판 기획자입니다.
수많은 책의 목차를 구성하고 개선한 경험이 있습니다.

## 평가 대상: 책 목차
{content}

## 평가 기준 (각 10점 만점)

### 1. 논리적 흐름
- 앞 챕터가 뒤 챕터의 기반이 되는가?
- 독자가 자연스럽게 따라올 수 있는 순서인가?
- Part 간 전환이 매끄러운가?

### 2. 완결성
- 독자가 궁금해할 내용이 빠지지 않았는가?
- 각 Part가 충분한 내용을 담고 있는가?
- 시작부터 끝까지 완결된 스토리인가?

### 3. 중복 제거
- 비슷한 내용이 반복되지 않는가?
- 합칠 수 있는 챕터가 있는가?
- 불필요한 챕터가 있는가?

### 4. 매력도
- 목차만 봐도 읽고 싶어지는가?
- 챕터 제목이 호기심을 유발하는가?
- 베스트셀러처럼 보이는가?

### 5. 실용성
- 독자가 실제로 적용할 수 있는가?
- 추상적이지 않고 구체적인가?
- 행동으로 옮길 수 있는 내용인가?

## 출력 형식

### 종합 점수
| 기준 | 점수 | 코멘트 |
|------|------|--------|
| 논리적 흐름 | /10 | ... |
| 완결성 | /10 | ... |
| 중복 제거 | /10 | ... |
| 매력도 | /10 | ... |
| 실용성 | /10 | ... |
| **총점** | **/50** | |

### 구체적 개선 제안
1. **삭제 권장**: 삭제하면 좋을 챕터와 이유
2. **추가 권장**: 추가하면 좋을 주제와 위치
3. **순서 변경**: 순서를 바꾸면 좋을 챕터
4. **제목 수정**: 더 매력적인 제목 제안

### 베스트 5 챕터
가장 잘 된 챕터 5개와 그 이유

### 우선 개선 3가지
가장 시급하게 고쳐야 할 3가지를 우선순위대로 제시해주세요."""

    else:  # draft
        return f"""당신은 베스트셀러 전담 편집자이자 글쓰기 코치입니다.
원고를 읽고 출판 가능 수준으로 개선하는 피드백을 제공합니다.

## 평가 대상: 원고
{content}

## 평가 기준 (각 10점 만점)

### 1. 논리적 흐름
- 도입-본론-결론 구조가 명확한가?
- 문단 간 연결이 자연스러운가?
- 주장과 근거가 잘 연결되는가?

### 2. 가독성
- 문장이 짧고 명확한가?
- 전문 용어 없이 쉽게 읽히는가?
- 시각적으로 읽기 편한가? (문단, 소제목 등)

### 3. 설득력
- 구체적인 사례나 데이터가 있는가?
- 독자가 "맞아, 그렇지!"라고 고개를 끄덕이게 하는가?
- 감정적으로 공감이 되는가?

### 4. 독창성
- 다른 책에서 본 적 없는 관점이 있는가?
- 저자만의 목소리가 느껴지는가?
- 새로운 인사이트가 있는가?

### 5. 완성도
- 시작과 끝이 잘 맞물리는가?
- 빠진 내용이 없는가?
- 출판해도 될 수준인가?

## 출력 형식

### 종합 점수
| 기준 | 점수 | 한줄평 |
|------|------|--------|
| 논리적 흐름 | /10 | |
| 가독성 | /10 | |
| 설득력 | /10 | |
| 독창성 | /10 | |
| 완성도 | /10 | |
| **총점** | **/50** | |

### 잘된 점 TOP 3
구체적인 문장/문단을 인용하며 칭찬

### 개선 포인트 TOP 3
구체적인 문장/문단을 지적하며 개선 방향 제시

### Before/After 수정 예시
가장 개선이 필요한 부분의 수정 전/후 예시 제공

### 최우선 수정 과제
지금 당장 고쳐야 할 1가지와 그 방법을 명확히 제시해주세요."""


def get_refine_prompt(text: str) -> str:
    """문장 다듬기 프롬프트"""
    return f"""아래 글을 다듬어주세요:

{text}

수정 기준:
1. 어색한 표현 → 자연스러운 한국어로
2. 긴 문장 → 2개로 나누기
3. 반복되는 단어 → 동의어로 교체
4. 딱딱한 표현 → 친근한 표현으로
5. 수동태 → 능동태로
6. 한자어 과다 → 쉬운 말로

출력 형식:
[수정된 글]

---
[수정 내역]
- 원문: "~" → 수정: "~" (이유: ~)"""


def get_storytelling_prompt(experience: str) -> str:
    """스토리텔링 프롬프트"""
    return f"""내 경험 원본:
{experience}

이 경험을 아래 구조로 스토리텔링해주세요:

1. 상황 (Before): 당시 나의 상태, 감정, 환경
2. 문제 (Conflict): 겪은 어려움, 고민
3. 전환점 (Turning Point): 깨달음의 순간
4. 행동 (Action): 무엇을 했는지
5. 결과 (After): 변화된 모습
6. 교훈 (Lesson): 독자가 얻을 인사이트

분량: 800-1000자
톤: 담담하지만 진정성 있게

출력 형식:
[스토리 제목]
[본문]
[핵심 교훈 한 줄]"""


# 글쓰기 톤 옵션
WRITING_TONES = [
    "친근한 (독자와 대화하듯)",
    "전문적인 (신뢰감 있는)",
    "유머러스한 (재미있고 가벼운)",
    "감성적인 (감동을 주는)",
    "실용적인 (바로 적용 가능한)",
]


def get_proposal_generation_prompt(book_info: dict, author_info: dict) -> str:
    """출간기획서 생성 프롬프트"""
    return f"""내 책 정보:
- 제목: {book_info.get('title', '')}
- 주제: {book_info.get('topic', '')}
- 타겟 독자: {book_info.get('target_reader', '')}
- 핵심 메시지: {book_info.get('core_message', '')}

저자 정보:
- 이름: {author_info.get('name', '')}
- 직업/전문 분야: {author_info.get('profession', '')}
- 경력/전문성: {author_info.get('career', '')}
- 대표 성과: {author_info.get('achievements', '')}
- SNS/블로그: {author_info.get('sns', '')}
- 연락처: {author_info.get('contact', '')}

## 기획서 7가지 구성 요소를 모두 포함해서 작성해주세요:

1. **제목 & 부제목**: 임팩트 있는 제목과 구체적 부제목
2. **기획 의도**: 이 책이 왜 필요한지, 왜 내가 쓸 수 있는지 (3문장)
3. **타겟 독자**: 주 타겟, 부 타겟, 예상 시장 규모
4. **시장 분석**: 유사 도서 3권과의 차별점, USP
5. **목차 요약**: 5부 구조 간략 소개
6. **저자 소개**: 신뢰도를 높이는 경력/전문성
7. **마케팅 계획**: 보유 채널, 출간 전후 홍보 계획

## 요구사항:
1. A4 2페이지 분량으로 간결하게
2. 출판사 편집자가 5분 안에 읽을 수 있도록
3. 구체적인 숫자 포함 (예상 판매량, 타겟 규모 등)
4. 차별점과 시장성 강조

출판사 편집자가 "이 책 출판하고 싶다"고 느낄 수 있도록 작성해주세요."""


def get_landing_page_prompt(book_info: dict, webinar_info: dict) -> str:
    """랜딩페이지 카피 생성 프롬프트"""
    return f"""책/웨비나 정보:
- 책 제목: {book_info.get('title', '')}
- 주제: {book_info.get('topic', '')}
- 타겟 독자: {book_info.get('target_reader', '')}
- 핵심 메시지: {book_info.get('core_message', '')}

웨비나/이벤트 정보:
- 웨비나 제목: {webinar_info.get('webinar_title', '')}
- 일시: {webinar_info.get('datetime', '')}
- 강사: {webinar_info.get('speaker', '')}
- 주요 내용: {webinar_info.get('content', '')}
- 보너스/혜택: {webinar_info.get('bonus', '')}

## 랜딩페이지 10개 섹션 카피를 작성해주세요:

1. **헤더 (Hero)**: 3초 안에 시선 강탈 (A/B/C 3가지 버전)
2. **문제 제기**: "나도 이런 고민..." 공감 형성
3. **해결책 제시**: 웨비나에서 알려줄 3가지
4. **강사 소개**: 신뢰 구축
5. **커리큘럼**: 90분 타임테이블
6. **사회적 증거**: 후기/성과 데이터
7. **보너스/혜택**: 참석자 선물
8. **CTA (신청 폼)**: 신청 유도
9. **FAQ**: 자주 묻는 질문 5개
10. **최종 CTA**: 마지막 푸시

## 요구사항:
1. 전환율 30% 이상 목표
2. 긴급성/희소성 요소 포함
3. CTA 버튼 문구 5가지 버전
4. 타겟의 언어로 (전문 용어 최소화)
5. 마크다운 형식으로 깔끔하게

신청하고 싶어지는 카피를 작성해주세요."""
